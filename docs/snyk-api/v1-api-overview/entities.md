# Entities

The API is a REST API. It has the following entities:

#### Test result

The test result is the object returned from the API giving the results of testing a package for issues. It has the following fields:

|        Property | Type    | Description                                           | Example                                                         |
| --------------: | ------- | ----------------------------------------------------- | --------------------------------------------------------------- |
|              ok | boolean | Does this package have one or more issues?            | false                                                           |
|          issues | object  | The issues found. See below for details.              | See below                                                       |
| dependencyCount | number  | The number of dependencies the package has.           | 9                                                               |
|             org | object  | The organization this test was carried out for.       | {"name": "anOrg", "id": "5d7013d9-2a57-4c89-993c-0304d960193c"} |
|  licensesPolicy | object  | The organization's licenses policy used for this test | See in the examples                                             |
|  packageManager | string  | The package manager for this package                  | "maven"                                                         |

Issue

An issue is either a vulnerability or a license issue, according to the organization's policy. It has the following fields:

|       Property | Type                                         | Description                                                                                                                                                                                                                                                   | Example                                                                                                                 |
| -------------: | -------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ----------------------------------------------------------------------------------------------------------------------- |
|             id | string                                       | The issue ID                                                                                                                                                                                                                                                  | "SNYK-JS-BACKBONE-10054"                                                                                                |
|            url | string                                       | A link to the issue details on snyk.io                                                                                                                                                                                                                        | "[https://snyk.io/vuln/SNYK-JS-BACKBONE-10054](https://snyk.io/vuln/SNYK-JS-BACKBONE-10054)                             |
|          title | string                                       | The issue title                                                                                                                                                                                                                                               | "Cross Site Scripting"                                                                                                  |
|           type | string                                       | The issue type: "license" or "vulnerability".                                                                                                                                                                                                                 | "license"                                                                                                               |
|          paths | array                                        | The paths to the dependencies which have an issue, and their corresponding upgrade path (if an upgrade is available). [More information about from and upgrade paths](https://snyk.docs.apiary.io/#introduction/overview-and-entities/from-and-upgrade-paths) | <p>[<br>  {<br>    "from": ["a@1.0.0", "b@4.8.1"],<br>    "upgrade": [false, "b@4.8.2"]<br>  }<br>]</p>                 |
|        package | string                                       | The package identifier according to its package manager                                                                                                                                                                                                       | "backbone", "org.apache.flex.blazeds:blazeds"                                                                           |
|        version | string                                       | The package version this issue is applicable to.                                                                                                                                                                                                              | "0.4.0"                                                                                                                 |
|       severity | string                                       | The Snyk defined severity level: "critical", "high", "medium" or "low".                                                                                                                                                                                       | "high"                                                                                                                  |
|       language | string                                       | The package's programming language                                                                                                                                                                                                                            | "js"                                                                                                                    |
| packageManager | string                                       | The package manager                                                                                                                                                                                                                                           | "npm"                                                                                                                   |
|         semver | array\[string] OR map\[string]array\[string] | One or more [semver](https://semver.org) ranges this issue is applicable to. The format varies according to package manager.                                                                                                                                  | \["<0.5.0, >=0.4.0", "<0.3.8, >=0.3.6"] OR { "vulnerable": \["\[2.0.0, 3.0.0)"], "unaffected": \["\[1, 2)", "\[3, )"] } |

#### Vulnerability

A vulnerability in a package. In addition to all the fields present in an issue, a vulnerability also has these fields:

|        Property | Type    | Description                                                                                                                                                                                                                      | Example                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| --------------: | ------- | -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| publicationTime | Date    | The vulnerability publication time                                                                                                                                                                                               | "2016-02-11T07:16:18.857Z"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|  disclosureTime | Date    | The time this vulnerability was originally disclosed to the package maintainers                                                                                                                                                  | "2016-02-11T07:16:18.857Z"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           |
|    isUpgradable | boolean | Is this vulnerability fixable by upgrading a dependency?                                                                                                                                                                         | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|     description | string  | The detailed description of the vulnerability, why and how it is exploitable. Provided in markdown format.                                                                                                                       | "## Overview[`org.apache.logging.log4j:log4j-core`](http://search.maven.org/#search%7Cga%7C1%7Ca%3A%22log4j-core%22)\nIn Apache Log4j 2.x before 2.8.2, when using the TCP socket server or UDP socket server to receive serialized log events from another application, a specially crafted binary payload can be sent that, when deserialized, can execute arbitrary code.\n\n# Details\nSerialization is a process of converting an object into a sequence of bytes which can be persisted to a disk or database or can be sent through streams. The reverse process of creating object from sequence of bytes is called deserialization. Serialization is commonly used for communication (sharing objects between multiple hosts) and persistence (store the object state in a file or a database). It is an integral part of popular protocols like _Remote Method Invocation (RMI)_, _Java Management Extension (JMX)_, _Java Messaging System (JMS)_, _Action Message Format (AMF)_, _Java Server Faces (JSF) ViewState_, etc.\n\n\_Deserialization of untrusted data\_ ([CWE-502](https://cwe.mitre.org/data/definitions/502.html)), is when the application deserializes untrusted data without sufficiently verifying that the resulting data will be valid, letting the attacker to control the state or the flow of the execution. \n\nJava deserialization issues have been known for years. However, interest in the issue intensified greatly in 2015, when classes that could be abused to achieve remote code execution were found in a [popular library (Apache Commons Collection)](https://snyk.io/vuln/SNYK-JAVA-COMMONSCOLLECTIONS-30078). These classes were used in zero-days affecting IBM WebSphere, Oracle WebLogic and many other products.\n\nAn attacker just needs to identify a piece of software that has both a vulnerable class on its path, and performs deserialization on untrusted data. Then all they need to do is send the payload into the deserializer, getting the command executed.\n\n> Developers put too much trust in Java Object Serialization. Some even de-serialize objects pre-authentication. When deserializing an Object in Java you typically cast it to an expected type, and therefore Java's strict type system will ensure you only get valid object trees. Unfortunately, by the time the type checking happens, platform code has already created and executed significant logic. So, before the final type is checked a lot of code is executed from the readObject() methods of various objects, all of which is out of the developer's control. By combining the readObject() methods of various classes which are available on the classpath of the vulnerable application an attacker can execute functions (including calling Runtime.exec() to execute local OS commands).\n- Apache Blog\n\n\n## References\n- [NVD](https://web.nvd.nist.gov/view/vuln/detail?vulnId=CVE-2017-5645)\n- [jira issue](https://issues.apache.org/jira/browse/LOG4J2-1863)\n" |
|     isPatchable | boolean | Is this vulnerability fixable by using a Snyk supplied patch?                                                                                                                                                                    | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|      isPinnable | boolean | Is this vulnerability fixable by pinning a transitive dependency                                                                                                                                                                 | true                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|     identifiers | object  | Additional vulnerability identifiers                                                                                                                                                                                             | {"CWE": \[], "CVE": \["CVE-2016-2402]}                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               |
|          credit | string  | The reporter of the vulnerability                                                                                                                                                                                                | "Snyk Security Team"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |
|          CVSSv3 | string  | Common Vulnerability Scoring System (CVSS) provides a way to capture the principal characteristics of a vulnerability, and produce a numerical score reflecting its severity, as well as a textual representation of that score. | "CVSS:3.0/AV:N/AC:L/PR:N/UI:N/S:U/C:L/I:N/A:N"                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
|       cvssScore | number  | CVSS Score                                                                                                                                                                                                                       | 5.3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |
|         patches | array   | Patches to fix this issue, by snyk                                                                                                                                                                                               | see "Patch" below.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |
|     upgradePath | object  | The path to upgrade this issue, if applicable                                                                                                                                                                                    | see below                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |
|       isPatched | boolean | Is this vulnerability patched?                                                                                                                                                                                                   | false                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                |
| exploitMaturity | string  | The snyk exploit maturity level                                                                                                                                                                                                  |                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      |

**Patch**

A patch is an object like this one:

```
{
  "urls": [
    "https://snyk-patches.s3.amazonaws.com/npm/backbone/20110701/backbone_20110701_0_0_0cdc525961d3fa98e810ffae6bcc8e3838e36d93.patch"
  ],
  "version": "<0.5.0 >=0.3.3",
  "modificationTime": "2015-11-06T02:09:36.180Z",
  "comments": [
    "https://github.com/jashkenas/backbone/commit/0cdc525961d3fa98e810ffae6bcc8e3838e36d93.patch"
  ],
  "id": "patch:npm:backbone:20110701:0"
}
```

#### From and upgrade paths

Both from and upgrade paths are arrays, where each item within the array is a package `name@version`.

Take the following `from` path:

```
[
  "my-project@1.0.0",
  "actionpack@4.2.5",
  "rack@1.6.4"
]
```

Assuming this was returned as a result of a test, then we know:

* The package that was tested was `my-project@1.0.0`
* The dependency with an issue was included in the tested package via the direct dependency `actionpack@4.2.5`
* The dependency with an issue was [rack@1.6.4](https://snyk.io/vuln/rubygems:rack@1.6.4)

Take the following `upgrade` path:

```
[
  false,
  "actionpack@5.0.0",
  "rack@2.0.1"
]
```

Assuming this was returned as a result of a test, then we know:

* The package that was tested is not upgradable (`false`)
* The direct dependency `actionpack` should be upgraded to at least version `5.0.0` in order to fix the issue
* Upgrading `actionpack` to version `5.0.0` will cause `rack` to be installed at version `2.0.1`

If the `upgrade` path comes back as an empty array (`[]`) then this means that there is no upgrade path available which would fix the issue.

#### License issue

A license issue has no additional fields other than the ones in "Issue".

#### Snyk organization

The organization in Snyk this request is applicable to. The organization determines the access rights, licenses policy and is the unit of billing for private projects.

A Snyk organization has these fields:

| Property | Type   | Description                   | Example                                |
| -------: | ------ | ----------------------------- | -------------------------------------- |
|     name | string | The organization display name | "deelmaker"                            |
|       id | string | The ID of the organization    | "3ab0f8d3-b17d-4953-ab6d-e1cbfe1df385" |

### Errors

This is a beta release of this API. Therefore, despite our efforts, errors might occur. In the unlikely event of such an error, it will have the following structure as JSON in the body:

| Property | Type    | Description                       | Example                                                                  |
| -------: | ------- | --------------------------------- | ------------------------------------------------------------------------ |
|  message | string  | Error message with reference      | Error calling Snyk api (reference: 39db46b1-ad57-47e6-a87d-e34f6968030b) |
| errorRef | V4 uuid | An error ref to contact Snyk with | 39db46b1-ad57-47e6-a87d-e34f6968030b                                     |

The error reference will also be supplied in the `x-error-reference` header in the server reply.

Example response:

```
HTTP/1.1 500 Internal Server Error
x-error-reference: a45ec9c1-065b-4f7b-baf8-dbd1552ffc9f
Content-Type: application/json; charset=utf-8
Content-Length: 1848
Vary: Accept-Encoding
Date: Sun, 10 Sep 2017 06:48:40 GMT
```
